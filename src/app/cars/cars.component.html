<div class="row">
  <div class="col-md-12 offset-md-0 col-sm-12 offset-sm-0">
    <h4 class="text-muted mt-2 mb-3 border-bottom pb-2 d-flex">
      Manage Cars
      <button
        (click)="showEditModal(getNewCar(), editCarModal, false)"
        class="btn btn-outline-danger btn-sm shadow-sm ms-auto"
      >
        <i class="fa fa-plus me-1"></i> Add New Car
      </button>
    </h4>
    <ul class="list-group" *ngIf="cars$ | async as cars; else noCarsToShow">
      <li
        class="list-group-item d-flex align-items-center"
        *ngFor="let car of cars"
      >
        <h6 class="m-0 p-0 w-100 me-2">
          <h5
            [class.border-bottom]="car.open"
            [class.mb-2]="car.open"
            [class.pb-2]="car.open"
            class="w-100 d-flex align-items-center m-0 p-0"
          >
            <span role="button" (click)="car.open = !car.open">
              <i class="fa fa-car me-2 text-danger"></i> {{ car.title }}
            </span>
            <button
              (click)="deleteCar(car)"
              title="Delete Car"
              class="btn btn-danger btn-sm ms-auto shadow-sm"
            >
              <i class="fa fa-trash"></i>
            </button>
            <!-- (click)="showEditModal(car, editCarModal)" -->
            <button
              title="Edit Car"
              class="btn btn-warning btn-sm ms-2 shadow-sm"
            >
              <i class="fa fa-edit"></i>
            </button>
          </h5>
          <ul class="list-group" *ngIf="!!car?.open">
            <li class="list-group-item">
              Brand : <span class="fw-bold">{{ car.brand }}</span>
            </li>
            <li class="list-group-item">
              Model : <span class="fw-bold">{{ car.model }}</span>
            </li>
            <li class="list-group-item">
              Type : <span class="fw-bold">{{ car.type }}</span>
            </li>
            <li class="list-group-item">
              No Of Seats : <span class="fw-bold">{{ car.noOfSeats }}</span>
            </li>
            <li class="list-group-item">
              Registration Number:
              <span class="fw-bold"> {{ car.registrationNumber }}</span>
            </li>
            <li class="list-group-item">
              Color : <span class="fw-bold">{{ car.color }}</span>
            </li>
            <li class="list-group-item">
              Chassie Number :
              <span class="fw-bold">{{ car.chassieNumber }}</span>
            </li>
            <li class="list-group-item">
              Engine Number :
              <span class="fw-bold">{{ car.engineNumber }}</span>
            </li>
            <li class="list-group-item">
              <div
                class="btn-group w-100"
                role="group"
                aria-label="Basic example"
              >
                <span
                  (click)="
                    openPhoto(car.rcPhoto, car.registrationNumber + 'RC Photo')
                  "
                  class="btn btn-outline-danger col"
                  >Show RC Photo</span
                >
                <span
                  (click)="
                    openPhoto(
                      car.polutionPhoto,
                      car.registrationNumber + 'Polution Photo'
                    )
                  "
                  class="btn btn-outline-danger col"
                  >Show Polution Photo</span
                >
                <span
                  (click)="
                    openPhoto(
                      car.insurancePhoto,
                      car.registrationNumber + 'Insurance Photo'
                    )
                  "
                  class="btn btn-outline-danger col"
                  >Show Insurance Photo</span
                >
              </div>
            </li>
          </ul>
        </h6>
      </li>
    </ul>
  </div>
</div>

<div
  class="modal fade"
  bsModal
  #imagePreview="bs-modal"
  [config]="{ backdrop: 'static' }"
  tabindex="-1"
  role="dialog"
  aria-labelledby="dialog-static-name"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h6 id="dialog-static-name" class="modal-title pull-left">
          {{ previewImageTitle }}
        </h6>
        <button
          class="btn btn-outline-danger btn-sm"
          (click)="imagePreview.hide()"
        >
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="modal-body text-center">
        <img [src]="previewImageUrl" [alt]="previewImageTitle" />
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  bsModal
  #editCarModal="bs-modal"
  [config]="{ backdrop: 'static' }"
  tabindex="-1"
  role="dialog"
  aria-labelledby="dialog-static-name"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h6 id="dialog-static-name" class="modal-title pull-left">
          {{ isEdit ? "Edit" : "Add New " }} Car
        </h6>
        <button
          class="btn btn-outline-danger btn-sm"
          (click)="editCarModal.hide()"
        >
          <i class="fa fa-times"></i>
        </button>
      </div>
      <div class="modal-body pt-1" *ngIf="editCarModal.isShown">
        <ng-firestore-form #form [controls]="controls"></ng-firestore-form>
        <div class="d-flex">
          <button
            type="button"
            (click)="form.resetForm()"
            class="w-50 btn btn-dark me-1"
          >
            Reset
          </button>
          <button
            (click)="saveEdit(editCarModal, form.firesoteForm)"
            [disabled]="!!form.invalid"
            class="w-50 btn btn-danger ms-1"
          >
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #noCarsToShow>
  <h5 class="text-center text-danger">
    <i class="fa fa-exclamation text-danger" aria-hidden="true"></i> No Cars to
    Show...
  </h5>
</ng-template>
